<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>美容データ - ライングラフ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.44.0/apexcharts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #000;
            color: #fff;
            font-family: 'Helvetica Neue', Arial, sans-serif;
            padding: 20px 10px;
        }
        
        .graph_container {
            max-width: 100%;
            margin: 0 auto;
        }
        
        .graph_header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .graph_header h1 {
            font-size: 24px;
            color: #fff;
            margin-bottom: 10px;
        }
        
        .graph_chart_container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 10px 0px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }
        
        #graph_chart {
            width: 100%;
            height: 400px;
            margin: 0;
            padding: 0;
        }
        
        /* ApexChartsの内部マージンを強制的に削除 */
        #graph_chart .apexcharts-canvas {
            margin: 0 !important;
            padding: 0 !important;
        }
        
        @media (max-width: 480px) {
            .graph_container {
                padding: 0 5px;
            }
            
            .graph_header h1 {
                font-size: 20px;
            }
            
            .graph_chart_container {
                padding: 15px 5px;
            }
            
            #graph_chart {
                height: 350px;
            }
        }
    </style>
</head>
<body>
    <div class="graph_container">
        <div class="graph_chart_container">
            <div id="graph_chart"></div>
        </div>
    </div>

    <script>
        let chart;
        
        // データ設定（初期値）
        const defaultData = {
            dPoint: [244.7, 251.1, 248.5, 250.2, 255.3, 252.4],
            vPoint: [74.1, 77.9, 80.3, 78.6, 79.6, 78.5],
            wrinkles: [88.49, 84.959, 120.64, 127.275, 62.007, 93.36]  // 100で割った値
        };
        
        // X軸のカテゴリを生成（1から開始）
        function generateDays(count) {
            return Array.from({length: count}, (_, i) => i + 1);
        }
        
        // データを指定された日数に合わせて調整
        function adjustDataLength(data, targetLength) {
            const result = [...data];
            while (result.length < targetLength) {
                result.push(null); // データがない日はnullで埋める
            }
            return result.slice(0, targetLength);
        }
        
        // メインのグラフ初期化関数
        function initChart(data, days, type) {
            // 既存のチャートがある場合は破棄
            if (chart) {
                chart.destroy();
            }
            
            // 表示するシリーズを決定
            let series = [];
            switch(type) {
                case 'v':
                    series = [{
                        name: "たるみ度合い（V点）",
                        data: adjustDataLength(data.vPoint, days),
                        color: '#FEB019'
                    }];
                    break;
                case 'vd':
                    series = [
                        {
                            name: "フェイスライン（D点）",
                            data: adjustDataLength(data.dPoint, days),
                            color: '#00E396'
                        },
                        {
                            name: "たるみ度合い（V点）",
                            data: adjustDataLength(data.vPoint, days),
                            color: '#FEB019'
                        }
                    ];
                    break;
                case 'all':
                default:
                    series = [
                        {
                            name: "フェイスライン（D点）",
                            data: adjustDataLength(data.dPoint, days),
                            color: '#00E396'
                        },
                        {
                            name: "たるみ度合い（V点）",
                            data: adjustDataLength(data.vPoint, days),
                            color: '#FEB019'
                        },
                        {
                            name: "ほうれい線",
                            data: adjustDataLength(data.wrinkles, days),
                            color: '#FF4560'
                        }
                    ];
                    break;
            }
            
            // チャートオプション
            const options = {
                series: series,
                chart: {
                    height: 400,
                    type: 'line',
                    background: 'transparent',
                    toolbar: {
                        show: false
                    },
                    zoom: {
                        enabled: false
                    },
                    pan: {
                        enabled: false
                    }
                },
                plotOptions: {
                    line: {
                        dataLabels: {
                            position: 'top'
                        }
                    }
                },
                fill: {
                    type: 'solid'
                },
                theme: {
                    mode: 'dark'
                },
                dataLabels: {
                    enabled: true,
                    style: {
                        colors: ['#fff']
                    },
                    background: {
                        enabled: true,
                        foreColor: '#000',
                        borderRadius: 3,
                        padding: 4,
                        opacity: 0.8
                    }
                },
                stroke: {
                    curve: 'smooth',
                    width: 3
                },
                grid: {
                    borderColor: '#535A6C',
                    strokeDashArray: 3,
                    padding: {
                        left: 0,
                        right: 0,
                        top: 0,
                        bottom: 0
                    }
                },
                xaxis: {
                    categories: generateDays(days),
                    title: {
                        text: 'Day',
                        style: {
                            color: '#fff',
                            fontSize: '14px',
                            fontWeight: 500
                        }
                    },
                    labels: {
                        style: {
                            colors: '#fff'
                        },
                        formatter: function (val) {
                            return Math.floor(val);
                        }
                    },
                    axisBorder: {
                        show: true,
                        color: '#535A6C'
                    },
                    axisTicks: {
                        show: true,
                        color: '#535A6C'
                    },
                    type: 'numeric',
                    forceNiceScale: false,
                    decimalsInFloat: 0
                },
                yaxis: {
                    labels: {
                        show: false
                    }
                },
                legend: {
                    labels: {
                        colors: '#fff'
                    },
                    position: 'top',
                    horizontalAlign: 'center'
                },
                markers: {
                    size: 6,
                    strokeWidth: 2,
                    strokeColors: '#000',
                    hover: {
                        size: 8
                    }
                },
                tooltip: {
                    theme: 'dark',
                    x: {
                        show: true
                    }
                },
                responsive: [{
                    breakpoint: 480,
                    options: {
                        chart: {
                            height: 350
                        },
                        legend: {
                            position: 'bottom'
                        },
                        dataLabels: {
                            enabled: false
                        }
                    }
                }]
            };
            
            chart = new ApexCharts(document.querySelector("#graph_chart"), options);
            chart.render();
        }
        
        // ページ読み込み時にデフォルトデータでチャートを初期化
        document.addEventListener('DOMContentLoaded', function() {
            initChart(defaultData, 7, 'v');
        });
        
        // 使用例（コンソールで実行可能）
        // const data = {
        //     dPoint: [244.7, 251.1, 248.5, 250.2, 255.3, 252.4],
        //     vPoint: [74.1, 77.9, 80.3, 78.6, 79.6, 78.5],
        //     wrinkles: [88.49, 84.959, 120.64, 127.275, 62.007, 93.36]
        // };
        // initChart(data, 7, "v");
    </script>
</body>
</html>
